---
jupyter:
  kernelspec:
    display_name: Python 3 (ipykernel)
    language: python
    name: python3
  language_info:
    codemirror_mode:
      name: ipython
      version: 3
    file_extension: .py
    mimetype: text/x-python
    name: python
    nbconvert_exporter: python
    pygments_lexer: ipython3
    version: 3.11.9
  nbformat: 4
  nbformat_minor: 5
  papermill:
    default_parameters: {}
    duration: 1.969367
    end_time: "2024-05-24T15:47:26.602970"
    environment_variables: {}
    input_path: practice/003.ipynb
    output_path: practice/003.ipynb
    parameters: {}
    start_time: "2024-05-24T15:47:24.633603"
    version: 2.6.0
---

<div id="829c6a0a" class="cell code" execution_count="1"
execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-24T15:47:25.776893Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-24T15:47:25.776479Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-24T15:47:26.166476Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-24T15:47:26.165916Z&quot;}"
papermill="{&quot;duration&quot;:0.395767,&quot;end_time&quot;:&quot;2024-05-24T15:47:26.167971&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-24T15:47:25.772204&quot;,&quot;status&quot;:&quot;completed&quot;}"
tags="[]">

``` python
from typing import List, Optional, Generator
import pandas as pd
import numpy as np
import sqlite3
import re
import io
import math
import collections
import itertools
import functools
import random
import string
import tqdm
import bisect
import heapq

conn = sqlite3.connect(":memory:")

def regexp(expr, item):
    reg = re.compile(expr)
    return reg.search(item) is not None

def read_lc_df(s: str, dtypes: dict[str, str]=dict()) -> pd.DataFrame:
    temp = pd.read_csv(io.StringIO(s), sep="|", skiprows=2)
    temp = temp.iloc[1:-1, 1:-1]
    temp.columns = temp.columns.map(str.strip)
    temp = temp.map(lambda x: x if type(x) != str else None if x.strip() == 'null' else x.strip())
    temp = temp.astype(dtypes)
    return temp

conn.create_function("REGEXP", 2, regexp)
```

</div>

<div id="48286fb2" class="cell markdown"
papermill="{&quot;duration&quot;:2.566e-3,&quot;end_time&quot;:&quot;2024-05-24T15:47:26.173395&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-24T15:47:26.170829&quot;,&quot;status&quot;:&quot;completed&quot;}"
tags="[]">

#### Helper for Binary tree problems

</div>

<div id="d4eafef6" class="cell code" execution_count="2"
execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-24T15:47:26.179612Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-24T15:47:26.179133Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-24T15:47:26.186959Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-24T15:47:26.186432Z&quot;}"
lines_to_next_cell="1"
papermill="{&quot;duration&quot;:1.2224e-2,&quot;end_time&quot;:&quot;2024-05-24T15:47:26.188081&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-24T15:47:26.175857&quot;,&quot;status&quot;:&quot;completed&quot;}"
tags="[]">

``` python
class BinaryTreeNode:
    def __init__(self, val=0, left=None, right=None):
        self.val = val
        self.left = left
        self.right = right

    def to_list(self):
        to_visit = [self]
        visited = []
        while len(to_visit) > 0:
            curr = to_visit.pop(0)
            if curr:
                to_visit.append(curr.left)
                to_visit.append(curr.right)
                visited.append(curr.val)
            else:
                visited.append(curr)

        while visited and not visited[-1]:
            visited.pop()

        return visited

    def __str__(self):
        return str(self.val)

    @staticmethod
    def from_array(nums: list[int|None]):
        '''Create a Tree from a list of nums. Returns the root node.'''
        if len(nums) == 0:
            return None
        elif len(nums) == 1:
            return BinaryTreeNode(nums[0])
        else:
            forest = [BinaryTreeNode(nums[0])]
            parent_idx = -1
            for i in range(1, len(nums)):

                curr = None
                if nums[i] is not None:
                    curr = BinaryTreeNode(nums[i])
                    forest.append(curr)

                if i % 2 == 1:
                    parent_idx += 1
                    forest[parent_idx].left = curr
                else:
                    forest[parent_idx].right = curr

        return forest[0]
```

</div>

<div id="986c0064" class="cell markdown"
papermill="{&quot;duration&quot;:2.385e-3,&quot;end_time&quot;:&quot;2024-05-24T15:47:26.192992&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-24T15:47:26.190607&quot;,&quot;status&quot;:&quot;completed&quot;}"
tags="[]">

#### Helper for Singly Linked lists

</div>

<div id="cccf3cca" class="cell code" execution_count="3"
execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-24T15:47:26.198977Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-24T15:47:26.198530Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-24T15:47:26.203296Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-24T15:47:26.202757Z&quot;}"
lines_to_next_cell="1"
papermill="{&quot;duration&quot;:8.972e-3,&quot;end_time&quot;:&quot;2024-05-24T15:47:26.204386&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-24T15:47:26.195414&quot;,&quot;status&quot;:&quot;completed&quot;}"
tags="[]">

``` python
class ListNode:
    def __init__(self, val=0, next=None):
        self.val = val
        self.next = next

    def __str__(self):
        return str(self.val)

    @staticmethod
    def to_singly_linked_list(nums: list[int]):
        root = prev = None
        for n in nums:
            curr = ListNode(n)
            # Init once
            if not root:
                root = curr
            if prev:
                prev.next = curr
            prev = curr

        return root

    def to_list(self) -> list[int]:
        result = []
        curr = self
        while curr:
            result.append(curr.val)
            curr = curr.next
        return result
```

</div>

<div id="3306cb42" class="cell markdown"
papermill="{&quot;duration&quot;:2.4e-3,&quot;end_time&quot;:&quot;2024-05-24T15:47:26.209306&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-24T15:47:26.206906&quot;,&quot;status&quot;:&quot;completed&quot;}"
tags="[]">

#### Utility to generate random BST

</div>

<div id="8a9a7fb1" class="cell code" execution_count="4"
execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-24T15:47:26.215513Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-24T15:47:26.215048Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-24T15:47:26.219473Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-24T15:47:26.219010Z&quot;}"
lines_to_next_cell="1"
papermill="{&quot;duration&quot;:8.85e-3,&quot;end_time&quot;:&quot;2024-05-24T15:47:26.220604&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-24T15:47:26.211754&quot;,&quot;status&quot;:&quot;completed&quot;}"
tags="[]">

``` python
def generateBST(N: int, min_: int, max_: int) -> BinaryTreeNode|None:
    def insert(curr: BinaryTreeNode|None, n: int) -> BinaryTreeNode:
        if not curr:
            curr = BinaryTreeNode(n)
        elif curr.val < n:
            curr.right = insert(curr.right, n)
        else:
            curr.left = insert(curr.left, n)

        return curr

    assert N <= max_ - min_, "Number of available samples must be >= N"
    root: BinaryTreeNode|None = None
    for n in np.random.choice(np.arange(min_, max_), size=N, replace=False):
        root = insert(root, n)

    return root
```

</div>

<div id="9a722649" class="cell markdown"
papermill="{&quot;duration&quot;:2.431e-3,&quot;end_time&quot;:&quot;2024-05-24T15:47:26.225639&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-24T15:47:26.223208&quot;,&quot;status&quot;:&quot;completed&quot;}"
tags="[]">

Best time to buy and sell stocks - I

</div>

<div id="4e905b5e" class="cell code" execution_count="5"
execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-24T15:47:26.232622Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-24T15:47:26.232125Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-24T15:47:26.236050Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-24T15:47:26.235623Z&quot;}"
lines_to_next_cell="1"
papermill="{&quot;duration&quot;:8.413e-3,&quot;end_time&quot;:&quot;2024-05-24T15:47:26.237231&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-24T15:47:26.228818&quot;,&quot;status&quot;:&quot;completed&quot;}"
tags="[]">

``` python
def stocks1(prices: list[int]) -> int:
    min_, max_profit = prices[0], 0
    for price in prices:
        max_profit = max(max_profit, price - min_)
        min_ = min(min_, price)

    return max_profit

# Testing the solution
assert stocks1([7,1,5,3,6,4]) == 5
assert stocks1([7,6,4,3,1]) == 0
```

</div>

<div id="b36063c0" class="cell markdown"
papermill="{&quot;duration&quot;:2.409e-3,&quot;end_time&quot;:&quot;2024-05-24T15:47:26.242193&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-24T15:47:26.239784&quot;,&quot;status&quot;:&quot;completed&quot;}"
tags="[]">

Weekly Contest 398: 19th May 2024

</div>

<div id="2d35821a" class="cell code" execution_count="6"
execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-24T15:47:26.248238Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-24T15:47:26.247876Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-24T15:47:26.252153Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-24T15:47:26.251682Z&quot;}"
lines_to_next_cell="1"
papermill="{&quot;duration&quot;:8.598e-3,&quot;end_time&quot;:&quot;2024-05-24T15:47:26.253257&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-24T15:47:26.244659&quot;,&quot;status&quot;:&quot;completed&quot;}"
tags="[]">

``` python
# Q1
def isArraySpecial(nums: list[int]) -> bool:
    N = len(nums)
    for i in range(N - 1):
        i1, i2 = nums[i] % 2, nums[i + 1] % 2
        if (i1 == 0 and i2 == 0) or (i1 == 1 and i2 == 1):
            return False
    else:
        return True

# Testing the solution
assert isArraySpecial([4,3,1,6]) == False
assert isArraySpecial([2,1,4]) == True
assert isArraySpecial([1]) == True
```

</div>

<div id="ce3280b2" class="cell code" execution_count="7"
execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-24T15:47:26.259108Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-24T15:47:26.258755Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-24T15:47:26.263958Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-24T15:47:26.263507Z&quot;}"
lines_to_next_cell="1"
papermill="{&quot;duration&quot;:9.959e-3,&quot;end_time&quot;:&quot;2024-05-24T15:47:26.265638&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-24T15:47:26.255679&quot;,&quot;status&quot;:&quot;completed&quot;}"
tags="[]">

``` python
# Q2
def isArraySpecial2(nums: list[int], queries: list[list[int]]) -> list[bool]:
    N = len(nums)
    parity: list[int] = list(map(lambda x: x % 2, nums))

    @functools.cache
    def backtrack(start: int, end: int) -> bool:
        if start == end:
            return True
        else:
            mid = (start + end) // 2
            isSpecial =  parity[mid] != parity[mid + 1] and backtrack(start, mid) and backtrack(mid + 1, end)
            return isSpecial

    result: list[bool] = []
    for i, j in queries:
        result.append(backtrack(i, j))

    return result

# Testing the solution
assert isArraySpecial2([4,3,1,6], [[0,2],[2,3]]) == [False, True]
assert isArraySpecial2([3,4,1,2,6], [[0,4]]) == [False]
```

</div>

<div id="7a8941ed" class="cell code" execution_count="8"
execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-24T15:47:26.272612Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-24T15:47:26.272215Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-24T15:47:26.331910Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-24T15:47:26.331350Z&quot;}"
lines_to_next_cell="1"
papermill="{&quot;duration&quot;:6.3949e-2,&quot;end_time&quot;:&quot;2024-05-24T15:47:26.332987&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-24T15:47:26.269038&quot;,&quot;status&quot;:&quot;completed&quot;}"
tags="[]">

``` python
# Q3
def sumDigitDifferencesBrute(nums: list[int]) -> int:
    length = len(str(nums[0]))
    count = 0
    for n1, n2 in itertools.combinations(nums, r=2):
        n1_str, n2_str = str(n1), str(n2)
        for i in range(length):
            if n1_str[i] != n2_str[i]:
                count += 1

    return count

def sumDigitDifferences(nums: list[int]) -> int:
    def count(arr: list[int]) -> int:
        N = len(arr)
        temp = 0
        for i in range(N - 1):
            temp += arr[i] * sum(arr[i + 1:])

        return temp

    length = len(str(nums[0]))
    digits_dict: dict[int, dict[str, int]] = dict()
    for n in nums:
        n_str = str(n)
        for i in range(length):
            positions = digits_dict.get(i, dict())
            positions[n_str[i]] = positions.get(n_str[i], 0) + 1
            digits_dict[i] = positions

    result: int = 0
    for i in range(length):
        result += count(list(digits_dict[i].values()))

    return result

# Testing the solution
for i in range(100):
    temp = list(np.random.randint(10, 100, 50))
    assert sumDigitDifferencesBrute(temp) == sumDigitDifferences(temp)
```

</div>

<div id="6d69bfc3" class="cell markdown"
papermill="{&quot;duration&quot;:2.509e-3,&quot;end_time&quot;:&quot;2024-05-24T15:47:26.338357&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-24T15:47:26.335848&quot;,&quot;status&quot;:&quot;completed&quot;}"
tags="[]">

Sum of XOR totals Easy LC:
<https://leetcode.com/problems/sum-of-all-subset-xor-totals>

</div>

<div id="3e8f2bd0" class="cell code" execution_count="9"
execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-24T15:47:26.344423Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-24T15:47:26.344050Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-24T15:47:26.348439Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-24T15:47:26.347911Z&quot;}"
lines_to_next_cell="1"
papermill="{&quot;duration&quot;:8.808e-3,&quot;end_time&quot;:&quot;2024-05-24T15:47:26.349555&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-24T15:47:26.340747&quot;,&quot;status&quot;:&quot;completed&quot;}"
tags="[]">

``` python
# https://leetcode.com/problems/sum-of-all-subset-xor-totals/submissions/1263288868
def subsetXORSumMemo(nums: list[int]) -> int:
    @functools.cache
    def backtrack(i: int, curr: int) -> int:
        if i == N:
            return curr
        else:
            return backtrack(i + 1, curr ^ nums[i]) + backtrack(i + 1, curr)

    N = len(nums)
    return backtrack(0, 0)

# Testing the solution
assert subsetXORSumMemo([1,3]) == 6
assert subsetXORSumMemo([5,1,6]) == 28
```

</div>

<div id="9b399353" class="cell markdown"
papermill="{&quot;duration&quot;:2.456e-3,&quot;end_time&quot;:&quot;2024-05-24T15:47:26.354528&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-24T15:47:26.352072&quot;,&quot;status&quot;:&quot;completed&quot;}"
tags="[]">

Largest Rectangle in a histogram

</div>

<div id="1eb77032" class="cell code" execution_count="10"
execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-24T15:47:26.360644Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-24T15:47:26.360188Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-24T15:47:26.367010Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-24T15:47:26.366458Z&quot;}"
lines_to_next_cell="1"
papermill="{&quot;duration&quot;:1.11e-2,&quot;end_time&quot;:&quot;2024-05-24T15:47:26.368055&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-24T15:47:26.356955&quot;,&quot;status&quot;:&quot;completed&quot;}"
tags="[]">

``` python
# https://leetcode.com/problems/largest-rectangle-in-histogram/submissions/1266278725
def largestRectangleArea(heights: list[int]) -> int:
    """
    Count the number of rectangles to the right that are greater than or equal to self
    Count the number of rectangles to the left that are greater than or equal to self
    """

    N = len(heights)

    right_dp: list[int] = [N - i for i in range(N)]
    left_dp: list[int] = [i + 1 for i in range(N)]
    stack: list[tuple[int, int]] = []

    for i in range(N):
        curr: tuple[int, int] = (heights[i], i)
        while stack and stack[-1][0] > curr[0]:
            prev = stack.pop()
            right_dp[prev[1]] = curr[1] - prev[1]
        stack.append(curr)

    stack.clear()

    for i in range(N - 1, -1, -1):
        curr = (heights[i], i)
        while stack and stack[-1][0] > curr[0]:
            prev = stack.pop()
            left_dp[prev[1]] = prev[1] - curr[1]
        stack.append(curr)

    max_ = 0
    for i in range(N):
        max_ = max(max_, (left_dp[i] + right_dp[i] - 1) * heights[i])

    return max_

# Testing the solution
assert largestRectangleArea([2,1,5,6,2,3]) == 10
assert largestRectangleArea([2,4]) == 4
assert largestRectangleArea([2,1,2]) == 3
```

</div>

<div id="05d83699" class="cell markdown"
papermill="{&quot;duration&quot;:2.494e-3,&quot;end_time&quot;:&quot;2024-05-24T15:47:26.373129&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-24T15:47:26.370635&quot;,&quot;status&quot;:&quot;completed&quot;}"
tags="[]">

Container Queries - CN Weekly - 3

</div>

<div id="e9d3612c" class="cell code" execution_count="11"
execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-24T15:47:26.378955Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-24T15:47:26.378735Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-24T15:47:26.384202Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-24T15:47:26.383679Z&quot;}"
papermill="{&quot;duration&quot;:9.813e-3,&quot;end_time&quot;:&quot;2024-05-24T15:47:26.385387&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-24T15:47:26.375574&quot;,&quot;status&quot;:&quot;completed&quot;}"
tags="[]">

``` python
def containerQueries(N: int, S: str, query_len: int, queries: list[list[int]]) -> list[int]:
    positions: dict[str, collections.deque[int]] = dict()
    for i in range(N):
        indices = positions.get(S[i], collections.deque())
        indices.append(i)
        positions[S[i]] = indices

    end_pos = 0
    for k in positions:
        end_pos = max(end_pos, positions[k].popleft())

    dp: list[int] = [end_pos]
    for i in range(1, N):
        prev = S[i - 1]
        next_pos = max(dp[-1], positions[prev].popleft() if positions[prev] else N)
        dp.append(next_pos)

    result: list[int] = []
    for i, j in queries:
        if j >= dp[i]:
            result.append(1)
        else:
            result.append(0)

    return result

# Testing the solution
assert containerQueries(8, "yukppuyk", 2, [[0,4],[5,7]]) == [1, 0]
```

</div>
